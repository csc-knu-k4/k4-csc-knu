<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:OsvitaApp.Pages.Controls"
             xmlns:vm="clr-namespace:OsvitaApp.PageModels"
             xmlns:om="clr-namespace:OsvitaApp.Models.ObservableModels"
             xmlns:textInput="clr-namespace:Syncfusion.Maui.Toolkit.TextInputLayout;assembly=Syncfusion.Maui.Toolkit"
             xmlns:buttons="clr-namespace:Syncfusion.Maui.Toolkit.Buttons;assembly=Syncfusion.Maui.Toolkit"
             xmlns:mct="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:effectsView="clr-namespace:Syncfusion.Maui.Toolkit.EffectsView;assembly=Syncfusion.Maui.Toolkit"
             x:Class="OsvitaApp.Pages.SubjectPage"
             Title="SubjectPage"
             x:DataType="vm:SubjectPageVM"
             BackgroundColor="{x:StaticResource LightBackground}"
             Shell.NavBarIsVisible="False"
             ControlTemplate="{StaticResource PageBaseTemplate}">
    <ContentPage.Behaviors>
        <mct:EventToCommandBehavior EventName="NavigatedTo"
                                    Command="{Binding NavigatedToCommand}" />

    </ContentPage.Behaviors>

    <VerticalStackLayout Spacing="10">
        <Label Text="{Binding Subject.Title}" Style="{x:StaticResource PageTitle}"/>
        <CollectionView ItemsSource="{Binding Chapters}">
            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Vertical"
                                   ItemSpacing="7.5" />
            </CollectionView.ItemsLayout>

            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="om:ChapterObservableModel">
                    <controls:ChapterCard>

                        <ContentView.GestureRecognizers>
                            <TapGestureRecognizer
                                Command="{Binding x:DataType='vm:SubjectPageVM', Source={RelativeSource AncestorType={x:Type vm:SubjectPageVM}}, Path=ChapterClickedCommand}"
                                CommandParameter="{Binding .}" />

                        </ContentView.GestureRecognizers>

                    </controls:ChapterCard>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </VerticalStackLayout>
</ContentPage>